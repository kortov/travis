language: java
jdk:
  - oraclejdk8
services:
  - docker
  - postgresql
cache:
  directories:
    - $HOME/.m2
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
before_script:
  - psql -c "CREATE DATABASE sqlcmd;" -U postgres
  - psql -c "CREATE DATABASE test;" -U postgres
  - psql -c "CREATE USER sqlcmd WITH PASSWORD 'sqlcmd' SUPERUSER;" -U postgres
  - sudo echo "TYPE DATABASE USER ADDRESS METHOD" >> /etc/postgresql/9.6/main/pg_hba.conf
  - sudo echo "local all sqlcmd trust" >> /etc/postgresql/9.6/main/pg_hba.conf
  - psql -c "GRANT ALL PRIVILEGES ON DATABASE sqlcmd TO sqlcmd;" -U postgres
  - psql -c "GRANT ALL PRIVILEGES ON DATABASE test TO sqlcmd;" -U postgres
test:
  adapter: postgresql
  database: sqlcmd
addons:
  postgresql: "9.6"